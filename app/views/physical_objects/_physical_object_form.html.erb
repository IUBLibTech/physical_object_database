<% @controller ||= 'physical_objects' %>
<% @tm ||= @physical_object.technical_metadatum.as_technical_metadatum %>
<%= error_messages_for(@physical_object) %>
<%= error_messages_for(@tm) %>
<%= nested_form_for(@physical_object) do |f| %>
  <%= hidden_field_tag "repeat", @repeat %>
  <%if @edit_mode or @action == 'destroy' %>
    <div class="clear" ><%= submit_tag(@submit_text) %></div>
  <% end %>
  <%= render(partial: 'physical_objects/physical_object_metadata_fields', locals: {f: f}) %>
  <div class="clear">
    <%= render(partial: 'digital_provenance/show_digital_provenance', locals: {f: f}) %>
  </div>
  <div id="digi_status">
    <% unless @physical_object.digital_statuses.size <= 0 %>
      <h2>Digital Statuses</h2>
      <div>
        <%= @physical_object.mdpi_barcode %>'s digital files were received 
        <%= @physical_object.digital_start_readable %>.
        The object will <i>auto-accept</i> on <%= @physical_object.expires %> 
      </div>
      <table class="digi_status_table">
        <tr>
          <th>State</th>
          <th class="digi_status_date_col">Date</th>
          <th>Message</th>
        </tr>
        <% @physical_object.digital_statuses.order(created_at: :desc).each do |s| %>
          <tr>
            <td><%= s.state %></td>
            <td><%= s.created_at.strftime("%l:%M%P %B %-d, %Y") %></td>
            <td>
              <%= s.message %>
            </td>
          </tr>
        <% end %>
      </table>
    <% end %>
  </div>
  <%# add the submit and close off the form_for %>
<% end %>

